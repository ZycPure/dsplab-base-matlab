clear all;
xt=xtg;
N=2000;Fs=1000;T=1/Fs;Tp=N*T;
k=0:N-1;f=k/Tp;
t=[0:N-1]/Fs;
fp=120;fs=150;Rp=0.1;As=60;
wc=(fp+fs)/Fs;
B=2*pi*(fs-fp)/Fs;
M=ceil(11*pi/B);
hn=fir1(M-1,wc,blackman(M));
Hw=abs(fft(hn,N));
ywt=fftfilt(hn,xt,N-1);
figure;
subplot(2,1,1);plot(f,20*log10(Hw)/max(Hw));grid on;
xlabel('f/Hz');ylabel('幅度');
title('低通滤波器幅频特性');
axis([0,500,-160,5]);
subplot(2,1,2);plot(t,ywt);grid;
xlabel('t/s');ylabel('y_1(t)');
title('滤除噪声后的信号波形');

clear all;
xt=xtg;
N=1024;Fs=1000;T=1/Fs;Tp=N*T;
k=0:N-1;f=k/Tp;
K=2000;
t=0:T:(K-1)*T;
fp=120;fs=150;Rp=0.2;As=60;
fb=[fp,fs];
m=[1,0];
dev=[(10^(Rp/20)-1)/(10^(Rp/20)+1),10^(-As/20)];
[Ne,fo,mo,W]=remezord(fb,m,dev,Fs);
hn=remez(Ne,fo,mo,W);
Hw=abs(fft(hn,1024));
yet=fftfilt(hn,xt,N);
figure;
subplot(2,1,1);plot(f,20*log10(Hw)/max(Hw));grid on;
xlabel('f/Hz');ylabel('幅度');
title('低通滤波器的幅频特性');
axis([0,500,-80,5]);
subplot(2,1,2);plot(t,yet);grid on;
xlabel('t/s');ylabel('y_2(t)');
title('滤除噪声后的信号波形');


figure;
subplot(2,1,1);
[H1,w]=freqz(B,A,1000);
m=abs(H1);
plot(w/pi,20*log(m/max(m)));grid on;
title('低通滤波损耗函数曲线');
axis([0,1,-300,20]);
xlabel('w/pi');ylabel('H1');
subplot(2,1,2);
ss=0:0.02/1600:0.02-0.02/1600;
plot(ss,y1t);title('低通滤波后的波形');
axis([0,0.02,-1.2,1.2]);
xlabel('t/s');ylabel('ylt');