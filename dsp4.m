xt=xtg;
N=2000;Fs=1000;T=1/Fs;Tp=N*T;
k=0:N-1;f=k/Tp;
t=[0:N-1]/Fs;
fp=120;fs=150;Rp=0.1;As=70;
wc=(fp+fs)/Fs;
B=2*pi*(fs-fp)/Fs;
M=ceil(11*pi/B);
hn=fir1(M-1,wc,blackman(M));
Hw=abs(fft(hn,N));
ywt=fftfilt(hn,xt,N-1);
figure;
subplot(2,1,1);plot(f,20*log10(Hw)/max(Hw));grid on;
xlabel('f/Hz');ylabel('幅度');
title('低通滤波器幅频特性');
axis([0,500,-160,5]);
subplot(2,1,2);plot(t,ywt);grid;
xlabel('t/s');ylabel('y_1(t)');
title('滤除噪声后的信号波形');